{"version":3,"file":"magnus.js","sources":["../src/client.js","../src/error.js","../src/session.js","../src/actions.js","../src/localStorage.js","../src/storage.js","../src/reducers.js","../src/store.js","../src/util.js","../src/vue.js","../src/index.js"],"sourcesContent":["import fetch from 'isomorphic-fetch'\n\nlet issuerPromise = null\n\nconst MagnusClient = {\n\n  config: {\n    clientId: null,\n    endpoint: 'https://magnus.rogue.team',\n    issuer: null\n  },\n\n  fetch (input0, init0 = {}) {\n    const init = Object.assign({}, init0)\n    const options = init.options || {}\n    delete init.options\n    const input = MagnusClient.getURL(input0, options)\n    if (input === false) {\n      return MagnusClient.fetchIssuer().then(() => {\n        return MagnusClient.fetch(input0, init0)\n      })\n    }\n    return fetch(input, init)\n  },\n\n  fetchIssuer () {\n    if (issuerPromise === null) {\n      issuerPromise = MagnusClient.fetch(`/client/${MagnusClient.config.clientId}`, {\n        cache: 'default',\n        credentials: 'omit',\n        method: 'GET',\n        mode: 'cors',\n        options: {\n          authorization: false,\n          issuer: false\n        }\n      }).then((response) => {\n        return response.json()\n      }).then((data) => {\n        if (data && data.issuer) {\n          MagnusClient.config.issuer = data.issuer\n          return Promise.resolve(MagnusClient.config.issuer)\n        }\n        return Promise.reject(data)\n      }).catch((response) => {\n        issuerPromise = null\n        return Promise.reject(response)\n      })\n    }\n    return issuerPromise\n  },\n\n  getURL (input, options) {\n    if (options.issuer === false) {\n      return `${MagnusClient.config.endpoint}${input}`\n    }\n    if (MagnusClient.config.issuer === null) {\n      return false\n    }\n    return `${MagnusClient.config.issuer}${input}`\n  }\n\n}\n\nexport default MagnusClient\n","function ExtendableError () {\n  // Not passing \"newTarget\" because core-js would fall back to non-exotic\n  // object creation.\n  const instance = Reflect.construct(Error, Array.from(arguments))\n  Object.setPrototypeOf(instance, Object.getPrototypeOf(this))\n  instance.name = this.constructor.name\n  return instance\n}\n\nExtendableError.prototype = Object.create(Error.prototype, {\n  constructor: {\n    value: Error,\n    enumerable: false,\n    writable: true,\n    configurable: true\n  }\n})\n\nif (Object.setPrototypeOf) {\n  Object.setPrototypeOf(ExtendableError, Error)\n} else {\n  // eslint-disable-next-line no-proto\n  ExtendableError.__proto__ = Error\n}\n\nexport class MagnusError extends ExtendableError {\n  constructor (message, data) {\n    super(message)\n    this.data = data\n  }\n}\n","import jwtDecode from 'jwt-decode'\n\nconst MagnusSession = {\n\n  getAccessToken (state) {\n    if (state && state.session && state.session.accessToken) {\n      return state.session.accessToken\n    }\n    return null\n  },\n\n  getIdToken (state) {\n    if (state && state.session && state.session.idToken) {\n      return state.session.idToken\n    }\n    return null\n  },\n\n  getIdTokenExpirationDate (state) {\n    const idToken = MagnusSession.getIdToken(state)\n    if (idToken) {\n      try {\n        const decoded = jwtDecode(idToken)\n        if (typeof decoded.exp === 'undefined') {\n          return null\n        }\n        const d = new Date(0)\n        d.setUTCSeconds(decoded.exp)\n        return d\n      } catch (e) {\n        return null\n      }\n    }\n    return null\n  },\n\n  getIdTokenExpiresAfter (state) {\n    const d = MagnusSession.getIdTokenExpirationDate(state)\n    if (d === null) {\n      return 0\n    }\n    return (d.valueOf() - (new Date().valueOf())) / 1000\n  },\n\n  getRefreshToken (state) {\n    if (state && state.session && state.session.refreshToken) {\n      return state.session.refreshToken\n    }\n    return null\n  },\n\n  isIdTokenExpired (state, offsetSeconds = 0) {\n    const d = MagnusSession.getIdTokenExpirationDate(state)\n    if (d === null) {\n      return false\n    }\n    return !(d.valueOf() > (new Date().valueOf() + (offsetSeconds * 1000)))\n  },\n\n  isSessionExpired (state) {\n    if (state && state.session && state.session.version !== state.version) {\n      return true\n    }\n    return false\n  }\n\n}\n\nexport default MagnusSession\n","import MagnusClient from './client'\nimport { MagnusError } from './error'\nimport MagnusSession from './session'\n\n/* eslint-disable key-spacing, no-multi-spaces */\n\n/* Action Types */\n\nexport const AUTHENTICATE_REQUEST = 'AUTHENTICATE_REQUEST'\nexport const AUTHENTICATE_SUCCESS = 'AUTHENTICATE_SUCCESS'\nexport const AUTHENTICATE_FAILURE = 'AUTHENTICATE_FAILURE'\nexport const SIGN_IN_REQUEST      = 'SIGN_IN_REQUEST'\nexport const SIGN_IN_SUCCESS      = 'SIGN_IN_SUCCESS'\nexport const SIGN_IN_FAILURE      = 'SIGN_IN_FAILURE'\nexport const SIGN_OUT_REQUEST     = 'SIGN_OUT_REQUEST'\nexport const SIGN_OUT_SUCCESS     = 'SIGN_OUT_SUCCESS'\nexport const SIGN_OUT_FAILURE     = 'SIGN_OUT_FAILURE'\n\n/* Action Creators */\n\nfunction authenticateRequest () {\n  return {\n    type: AUTHENTICATE_REQUEST,\n    payload: null\n  }\n}\n\nfunction authenticateSuccess (session) {\n  return {\n    type: AUTHENTICATE_SUCCESS,\n    payload: {\n      session\n    }\n  }\n}\n\nfunction authenticateFailure (error) {\n  return {\n    type: AUTHENTICATE_FAILURE,\n    payload: {\n      error\n    }\n  }\n}\n\nfunction signinRequest () {\n  return {\n    type: SIGN_IN_REQUEST,\n    payload: null\n  }\n}\n\nfunction signinSuccess (session) {\n  return {\n    type: SIGN_IN_SUCCESS,\n    payload: {\n      session\n    }\n  }\n}\n\nfunction signinFailure (error) {\n  return {\n    type: SIGN_IN_FAILURE,\n    payload: {\n      error\n    }\n  }\n}\n\nfunction signoutRequest () {\n  return {\n    type: SIGN_OUT_REQUEST,\n    payload: null\n  }\n}\n\nfunction signoutSuccess (session) {\n  return {\n    type: SIGN_OUT_SUCCESS,\n    payload: {\n      session\n    }\n  }\n}\n\nfunction signoutFailure (error) {\n  return {\n    type: SIGN_OUT_FAILURE,\n    payload: {\n      error\n    }\n  }\n}\n\n/* Actions */\n\nexport const MagnusActions = {\n\n  authenticate (force = false) {\n    return (dispatch, getState) => {\n      const { magnus: state } = getState()\n      if (state.isAuthenticated === true && state.session && force === false && state.session.tokeninfo) {\n        return Promise.resolve(authenticateSuccess(state.session))\n      }\n      dispatch(authenticateRequest())\n      return dispatch(_authenticate())\n        .then((session) => dispatch(authenticateSuccess(session)))\n        .catch((error) => Promise.reject(dispatch(authenticateFailure(error))))\n    }\n  },\n\n  signin (opts) {\n    const options = Object.assign({}, opts)\n    return (dispatch) => {\n      dispatch(signinRequest())\n      return _signin(options)\n        .then((data) => _userinfo(data))\n        .then((session) => dispatch(signinSuccess(session)))\n        .catch((error) => Promise.reject(dispatch(signinFailure(error))))\n    }\n  },\n\n  signout () {\n    return (dispatch, getState) => {\n      const { magnus: state } = getState()\n      dispatch(signoutRequest())\n      return _signout()\n        .then(() => dispatch(signoutSuccess(state.session)))\n        .catch((error) => Promise.reject(dispatch(signoutFailure(error))))\n    }\n  }\n\n}\n\n/** Authenticate **/\n\nfunction _authenticate () {\n  return (dispatch) => {\n    return dispatch(_authenticateWithTokeninfo())\n      .catch((error) => {\n        if (error.message === 'invalid token') {\n          return dispatch(_authenticateWithSSO())\n        }\n        return Promise.reject(error)\n      })\n  }\n}\n\nfunction _authenticateWithTokeninfo () {\n  return (dispatch, getState) => {\n    dispatch\n    const { magnus: state } = getState()\n    const idToken = MagnusSession.getIdToken(state)\n    if (idToken && !MagnusSession.isSessionExpired(state) && !MagnusSession.isIdTokenExpired(state)) {\n      return MagnusClient.fetch('/tokeninfo', {\n        body: JSON.stringify({\n          id_token: idToken\n        }),\n        cache: 'no-cache',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json;charset=UTF-8'\n        },\n        method: 'POST',\n        mode: 'cors',\n        options: {\n          authorization: false\n        }\n      })\n        .then((response) => response.json())\n        .then((tokeninfo) => {\n          return {\n            ...state.session,\n            tokeninfo\n          }\n        })\n        .catch((error) => {\n          if (error && error.status && error.status !== 401 && (state.session.tokeninfo || state.session.userinfo)) {\n            return {\n              ...state.session,\n              tokeninfo: state.session.tokeninfo || state.session.userinfo\n            }\n          }\n          return Promise.reject(new MagnusError('bad tokeninfo response', error))\n        })\n    }\n    return Promise.reject(new MagnusError('invalid token'))\n  }\n}\n\nfunction _authenticateWithSSO () {\n  return (dispatch) => {\n    return MagnusClient.fetch('/user/ssodata', {\n      cache: 'no-cache',\n      credentials: 'include',\n      method: 'GET',\n      mode: 'cors',\n      options: {\n        authorization: false\n      }\n    })\n      .then((response) => response.json())\n      .then((json) => {\n        if (json && json.lastUsedConnection && json.lastUsedConnection.name && json.sso === true) {\n          const options = {\n            connection: json.lastUsedConnection.name,\n            sso: true\n          }\n          return dispatch(MagnusActions.signin(options)).then(({ payload: { session } }) => {\n            return session\n          })\n        }\n        return Promise.reject(json)\n      })\n      .catch((error) => {\n        return Promise.reject(new MagnusError('invalid SSO', error))\n      })\n  }\n}\n\n/** Sign-In **/\n\nfunction _signin (options) {\n  const scope = options.scope || 'openid email profile'\n  return _signinDefault(options).then((response) => response.json()).then((data) => {\n    if (data && data.access_token && data.id_token && (scope.indexOf('offline_access') === -1 || data.refresh_token)) {\n      return data\n    } else {\n      return Promise.reject(new MagnusError('invalid response', data))\n    }\n  }, (error) => {\n    return Promise.reject(new MagnusError('caught exception', error))\n  })\n}\n\nfunction _signinDefault (options) {\n  if (options.sso !== false) {\n    options.sso = true\n  }\n\n  if (typeof options.username !== 'undefined' || typeof options.email !== 'undefined') {\n    return _signinWithUsernamePassword(options)\n  }\n\n  if (options.sso === true && typeof options.connection !== 'undefined') {\n    return _signinWithSSO(options)\n  }\n\n  return Promise.reject(new MagnusError('unhandled options', options))\n}\n\nfunction _signinWithSSO (options) {\n  const {\n    connection,\n    sso\n  } = options\n  const scope = options.scope || 'openid email profile'\n  const data = {\n    'client_id':  MagnusClient.config.clientId,\n    'connection': connection,\n    'grant_type': 'sso',\n    'scope':      scope,\n    'sso':        sso\n  }\n  return MagnusClient.fetch('/oauth/ro', {\n    body: JSON.stringify(data),\n    cache: 'no-cache',\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json;charset=UTF-8'\n    },\n    method: 'POST',\n    mode: 'cors',\n    options: {\n      authorization: false\n    }\n  })\n}\n\nfunction _signinWithUsernamePassword (options) {\n  const {\n    email,\n    username,\n    password,\n    connection,\n    sso\n  } = options\n  const scope = options.scope || 'openid email profile'\n  const data = {\n    'client_id':  MagnusClient.config.clientId,\n    'connection': connection || 'Username-Password-Authentication',\n    'grant_type': 'password',\n    'username':   username || email,\n    'password':   password,\n    'scope':      scope,\n    'sso':        sso\n  }\n  return MagnusClient.fetch('/oauth/ro', {\n    body: JSON.stringify(data),\n    cache: 'no-cache',\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json;charset=UTF-8'\n    },\n    method: 'POST',\n    mode: 'cors',\n    options: {\n      authorization: false\n    }\n  })\n}\n\nfunction _userinfo (data) {\n  if (!data || !data.access_token) {\n    return Promise.reject(new MagnusError('missing data.access_token', data))\n  }\n  return MagnusClient.fetch('/userinfo', {\n    cache: 'no-cache',\n    credentials: 'include',\n    headers: {\n      'Authorization': `Bearer ${data.access_token}`\n    },\n    method: 'GET',\n    mode: 'cors',\n    options: {\n      authorization: false\n    }\n  })\n    .then((response) => response.json())\n    .then((userinfo) => {\n      const session = {\n        accessToken:  data.access_token,\n        idToken:      data.id_token,\n        refreshToken: data.refresh_token,\n        tokeninfo:    null,\n        userinfo:     userinfo\n      }\n      return session\n    })\n    .catch((error) => {\n      return Promise.reject(new MagnusError('userinfo error', error))\n    })\n}\n\n/** Sign-Out **/\n\nfunction _signout () {\n  return MagnusClient.fetch('/logout', {\n    cache: 'no-cache',\n    credentials: 'include',\n    method: 'GET',\n    mode: 'cors',\n    options: {\n      authorization: false\n    }\n  })\n}\n\n/* eslint-enable key-spacing, no-multi-spaces */\n\nexport default MagnusActions\n","let localStorage\n\nif (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n  let internal = {}\n  localStorage = {\n    setItem (id, val) { internal[id] = String(val) },\n    getItem (id) { return internal.hasOwnProperty(id) ? internal[id] : undefined },\n    removeItem (id) { delete internal[id] },\n    clear () { internal = {} }\n  }\n} else {\n  localStorage = window.localStorage\n}\n\nexport default localStorage\n","import client from './client'\nimport localStorage from './localStorage'\n\nconst MagnusStorage = {\n\n  get key () {\n    return `magnus.${client.config.clientId}/session`\n  },\n\n  get local () {\n    return localStorage\n  },\n\n  load () {\n    if (typeof localStorage !== 'undefined' && typeof localStorage.getItem === 'function') {\n      let value = null\n      try {\n        value = JSON.parse(localStorage.getItem(MagnusStorage.key))\n      } catch (e) {\n        return null\n      }\n      return value\n    }\n    return null\n  },\n\n  dump (value) {\n    if (typeof localStorage !== 'undefined' && typeof localStorage.setItem === 'function') {\n      localStorage.setItem(MagnusStorage.key, JSON.stringify(value))\n    }\n    return value\n  }\n\n}\n\nexport default MagnusStorage\n","import { combineReducers } from 'redux'\nimport {\n  AUTHENTICATE_REQUEST,\n  AUTHENTICATE_SUCCESS,\n  AUTHENTICATE_FAILURE,\n  SIGN_IN_REQUEST,\n  SIGN_IN_SUCCESS,\n  SIGN_IN_FAILURE,\n  SIGN_OUT_REQUEST,\n  SIGN_OUT_SUCCESS,\n  SIGN_OUT_FAILURE\n} from './actions'\n\nfunction createReducer (initialState, map) {\n  return function magnus (state = initialState, action) {\n    const reducer = map[action.type]\n    return (reducer) ? reducer(state, action.payload) : state\n  }\n}\n\nexport const initialState = {\n  isAuthenticated: false,\n  isAuthenticating: false,\n  requests: 0,\n  session: null,\n  statusText: null,\n  version: 2\n}\n\nconst magnus = createReducer(initialState, {\n  [AUTHENTICATE_REQUEST]: (state) => {\n    return {\n      ...state,\n      isAuthenticating: true,\n      requests: state.requests + 1\n    }\n  },\n  [AUTHENTICATE_SUCCESS]: (state, { session }) => {\n    return {\n      ...state,\n      isAuthenticated: true,\n      isAuthenticating: false,\n      requests: state.requests - 1,\n      session: {\n        ...session,\n        version: state.version\n      }\n    }\n  },\n  [AUTHENTICATE_FAILURE]: (state, { error }) => {\n    return {\n      ...state,\n      isAuthenticated: false,\n      isAuthenticating: false,\n      requests: state.requests - 1,\n      session: null,\n      statusText: `Authentication Error: ${error.message}`\n    }\n  },\n  [SIGN_IN_REQUEST]: (state) => {\n    return {\n      ...state,\n      isAuthenticating: true,\n      requests: state.requests + 1,\n      statusText: null\n    }\n  },\n  [SIGN_IN_SUCCESS]: (state, { session }) => {\n    return {\n      ...state,\n      isAuthenticated: true,\n      isAuthenticating: false,\n      requests: state.requests - 1,\n      session: {\n        ...session,\n        version: state.version\n      },\n      statusText: 'You have been successfully logged in.'\n    }\n  },\n  [SIGN_IN_FAILURE]: (state, { error }) => {\n    return {\n      ...state,\n      isAuthenticated: false,\n      isAuthenticating: false,\n      requests: state.requests - 1,\n      session: null,\n      statusText: `Authentication Error: ${error.message}`\n    }\n  },\n  [SIGN_OUT_REQUEST]: (state) => {\n    return {\n      ...state,\n      isAuthenticated: false,\n      requests: state.requests + 1,\n      statusText: null\n    }\n  },\n  [SIGN_OUT_SUCCESS]: (state) => {\n    return {\n      ...state,\n      requests: state.requests - 1,\n      session: null,\n      statusText: 'You have been successfully logged out.'\n    }\n  },\n  [SIGN_OUT_FAILURE]: (state, { error }) => {\n    return {\n      ...state,\n      requests: state.requests - 1,\n      session: null,\n      statusText: `Authentication Error: ${error.message}`\n    }\n  }\n})\n\nconst MagnusReducers = combineReducers({\n  magnus\n})\n\nexport default MagnusReducers\n","import { createStore, applyMiddleware } from 'redux'\nimport thunkMiddleware from 'redux-thunk'\nimport reducers, { initialState } from './reducers'\nimport storage from './storage'\n\nconst preloadedState = {\n  magnus: {\n    ...initialState,\n    session: storage.load()\n  }\n}\n\nconst MagnusStore = createStore(reducers, preloadedState, applyMiddleware(thunkMiddleware))\n\nexport default MagnusStore\n","import isArray from 'lodash/isArray'\nimport isDate from 'lodash/isDate'\nimport isEqual from 'lodash/isEqual'\nimport isObject from 'lodash/isObject'\nimport isUndefined from 'lodash/isUndefined'\n\nconst MagnusUtil = {\n  changeset (o1, o2) {\n    if (isEqual(o1, o2)) {\n      return\n    } else {\n      if (isDate(o1) || isDate(o2)) {\n        if (isDate(o1) && isDate(o2) && isEqual(+o1, +o2)) {\n          return\n        } else {\n          return o2\n        }\n      } else if (isObject(o1) && isObject(o2) && !isArray(o1) && !isArray(o2)) {\n        const obj = {}\n        let key, val\n        for (key in o1) {\n          if (isUndefined(o2[key])) {\n            obj[key] = null\n          } else {\n            val = this.changeset(o1[key], o2[key])\n            if (!isUndefined(val)) {\n              obj[key] = val\n            }\n          }\n        }\n        for (key in o2) {\n          val = this.changeset(o1[key], o2[key])\n          if (!isUndefined(val)) {\n            obj[key] = val\n          }\n        }\n        return obj\n      } else {\n        return o2\n      }\n    }\n  }\n}\n\nexport default MagnusUtil\n","import magnus from './index.js'\n\nexport default {\n  install (Vue, options = {}) {\n    const clientConfig = ((options || {}).client) || {}\n    Object.assign(magnus.client.config, clientConfig)\n    Object.defineProperties(Vue.prototype, {\n      $magnus: {\n        get: function () {\n          return magnus\n        }\n      }\n    })\n  }\n}\n","import actions from './actions'\nimport client from './client'\nimport session from './session'\nimport storage from './storage'\nimport store from './store'\nimport util from './util'\nimport VueMagnus from './vue'\n\nclass Magnus {\n  constructor () {\n    this.subscription = this.store.subscribe(() => {\n      this.storage.dump(this.state.session)\n    })\n  }\n\n  get client () {\n    return client\n  }\n\n  get expiresAfter () {\n    return session.getIdTokenExpiresAfter(this.state)\n  }\n\n  get session () {\n    const state = this.state\n    return (state.session) ? state.session : null\n  }\n\n  get storage () {\n    return storage\n  }\n\n  get state () {\n    return this.store.getState().magnus\n  }\n\n  get store () {\n    return store\n  }\n\n  get util () {\n    return util\n  }\n\n  get vue () {\n    return VueMagnus\n  }\n\n  authenticate (force = false) {\n    return store.dispatch(actions.authenticate(force))\n  }\n\n  signin (options) {\n    return store.dispatch(actions.signin(options))\n  }\n\n  signout () {\n    return store.dispatch(actions.signout())\n  }\n\n  // subscribe only to changes to authentication state\n  subscribe (listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Listener must be a function')\n    }\n    let isAuthenticated = (() => {\n      const state = this.state\n      if (state.isAuthenticated && state.requests === 0) {\n        listener()\n        return state.isAuthenticated\n      }\n      return null\n    })()\n    return this.store.subscribe(() => {\n      const state = this.state\n      if (state.requests === 0 && state.isAuthenticated !== isAuthenticated) {\n        isAuthenticated = state.isAuthenticated\n        listener()\n      }\n    })\n  }\n}\n\nconst magnus = new Magnus()\n\nexport default magnus\n"],"names":["issuerPromise","MagnusClient","input0","init0","init","Object","assign","options","input","getURL","fetchIssuer","then","fetch","config","clientId","response","json","data","issuer","Promise","resolve","reject","catch","endpoint","ExtendableError","instance","Reflect","construct","Error","Array","from","arguments","setPrototypeOf","getPrototypeOf","name","constructor","prototype","create","__proto__","MagnusError","message","MagnusSession","state","session","accessToken","idToken","getIdToken","decoded","jwtDecode","exp","d","Date","setUTCSeconds","e","getIdTokenExpirationDate","valueOf","refreshToken","offsetSeconds","version","AUTHENTICATE_REQUEST","AUTHENTICATE_SUCCESS","AUTHENTICATE_FAILURE","SIGN_IN_REQUEST","SIGN_IN_SUCCESS","SIGN_IN_FAILURE","SIGN_OUT_REQUEST","SIGN_OUT_SUCCESS","SIGN_OUT_FAILURE","authenticateRequest","authenticateSuccess","authenticateFailure","error","signinRequest","signinSuccess","signinFailure","signoutRequest","signoutSuccess","signoutFailure","MagnusActions","force","dispatch","getState","magnus","isAuthenticated","tokeninfo","_authenticate","opts","_signin","_userinfo","_signout","_authenticateWithTokeninfo","_authenticateWithSSO","isSessionExpired","isIdTokenExpired","JSON","stringify","status","userinfo","lastUsedConnection","sso","signin","payload","scope","_signinDefault","access_token","id_token","indexOf","refresh_token","username","email","_signinWithUsernamePassword","connection","_signinWithSSO","password","localStorage","window","internal","id","val","String","hasOwnProperty","undefined","MagnusStorage","key","client","local","getItem","value","parse","setItem","createReducer","initialState","map","action","reducer","type","requests","MagnusReducers","combineReducers","preloadedState","storage","load","MagnusStore","createStore","reducers","applyMiddleware","thunkMiddleware","MagnusUtil","o1","o2","isEqual","isDate","isObject","isArray","obj","isUndefined","changeset","Vue","clientConfig","defineProperties","Magnus","subscription","store","subscribe","dump","actions","authenticate","signout","listener","getIdTokenExpiresAfter","util","VueMagnus"],"mappings":"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"}